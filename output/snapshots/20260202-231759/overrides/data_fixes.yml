version: 1

# Deterministic, documented data cleanups applied on top of the frozen Fresher snapshot.
# These should only be used to:
# - remove clear duplicates / mis-imported rows, and
# - add explicit linkage rows needed for auditability (not to "force-balance" totals).
#
# Apply with: `python3 scripts/97_apply_data_fixes.py`

wave_bills_delete:
  - wave_bill_id: 50
    reason: "Duplicate Canadian Tire Gas bill (same vendor/date/amount as bill 49); both linked to the same CC payment bank_txn_id=1583."
  - wave_bill_id: 90
    reason: "Duplicate/mislinked Pharmasave bill: only one CC purchase exists ($62.54 Pharmasave cc_txn_id=4095), but this bill was matched to Costco gas cc_txn_id=4082."
  - wave_bill_id: 541
    reason: "Shopify calendar-year CC fees bill (2024) duplicates Shopify payout-fee totals already captured from Shopify CSVs for FY2025; remove to avoid double counting."

# Add explicit CC payment → Wave bill links when the linkage is unambiguous but missing
# from the snapshot tables.
cc_payment_transfer_add:
  - bank_txn_id: 1602
    wave_bill_id: 89
    reason: "Pharmasave CC purchase (cc_txn_id=4095) reimbursed via CC payment to Mastercard (bank_txn_id=1602) — exact amount match."
  - bank_txn_id: 1020
    wave_bill_id: 365
    reason: "Dollarama split-CC bill total ($321.65) reimbursed via CC payment to Mastercard (bank_txn_id=1020) — exact amount match."

# Remove exact duplicate rows in bank_allocations (same bank_txn_id/target_id/amount).
dedupe_bank_allocations: true
